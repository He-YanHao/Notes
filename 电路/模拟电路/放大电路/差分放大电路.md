# 差分放大电路

## 什么是差分放大电路

**差分放大电路**是一种能够**放大两个输入信号差值**的电路，它只对差模信号进行放大，而对共模信号具有很强的抑制能力。这种"求差"的特性使其成为模拟集成电路中最重要的单元电路之一，是运算放大器、仪表放大器等电路的输入级核心。



## 差分放大电路基本原理

### 差分信号概念
- **差模信号**：两个输入端的差值信号 Vid = Vi1 - Vi2
- **共模信号**：两个输入端的平均值信号 Vic = (Vi1 + Vi2)/2

### 放大本质
差分放大电路实质上是利用电路的对称性来抑制温度漂移、电源波动等共模干扰，同时有效放大有用的差模信号。

```
Vi1 → [差分放大电路] → Vo = Ad×(Vi1 - Vi2) + Ac×(Vi1 + Vi2)/2
Vi2 → [差分放大电路] 
```
其中Ad为差模增益，Ac为共模增益



## 基本电路结构

### 经典BJT差分对

**电路原理图**
```
        VCC
         |
        [Rc1]     [Rc2]
         |         |
         +----+----+
         |    |    |
        Q1    |    Q2
         |    |    |
Vi1 -----+    |    +----- Vi2
              |
             [Re]
              |
             [Iee]
              |
             GND
```

**对称性要求**
- Q1、Q2特性匹配（β、Vbe相同）
- Rc1 = Rc2
- 信号源内阻相等



## 关键参数

#### 差模增益（Ad）

差模输出电压与差模输入电压的比值。
$$
A_d = \frac{V_{od}}{V_{id}}
$$
**对于基本差分对**：
$$
A_d = \frac{g_m R_c}{2}
$$
（单端输出）
$$
A_d = g_m R_c
$$
（双端输出）

#### 共模增益（Ac）

共模输出电压与共模输入电压的比值。
$$
A_c = \frac{V_{oc}}{V_{ic}}
$$
**理想情况下**：Ac ≈ 0



#### 共模抑制比（CMRR）

衡量电路抑制共模信号的能力，定义为差模增益与共模增益的比值。
$$
CMRR = \left| \frac{A_d}{A_c} \right|
$$
**常用单位**：分贝（dB）
$$
CMRR(dB) = 20\log_{10}\left( \frac{A_d}{A_c} \right)
$$
**一般范围**：

- 离散元件差分对：60-80 dB
- 集成运放输入级：90-120 dB
- 精密仪表放大器：100-140 dB

#### 输入失调电压（Vio）

使输出电压为零时，需要在输入端施加的直流电压差，反映电路的对称性。

#### 输入阻抗

- **差模输入阻抗**：rid = 2rπ（BJT）或 2∞（JFET）
- **共模输入阻抗**：ric ≈ βRe/2（BJT）



## 工作模式分析

### 差模工作情况

**等效电路**
```
        VCC
         |
        [Rc1]     [Rc2]
         |         |
        Q1        Q2
         |         |
+Vid/2 --+         +--- -Vid/2
         |         |
        [Re]      [Re]
         |         |
         +----+----+
              |
             [Iee]
              |
             GND
```

**工作特点**
- 两管电流变化大小相等、方向相反
- Re对差模信号相当于短路（虚地）
- 电压增益与单管共射放大器相当

### 共模工作情况

**等效电路**
```
        VCC
         |
        [Rc1]     [Rc2]
         |         |
        Q1        Q2
         |         |
  Vic ---+         +--- Vic
         |         |
        [Re]      [Re]
         |         |
         +----+----+
              |
             [2Re]  ← 等效电阻
              |
             [Iee]
              |
             GND
```

**工作特点**
- 两管电流变化大小相等、方向相同
- Re产生很强的负反馈，抑制共模增益
- 共模增益很小，理想情况下为零



## 改进型差分放大电路

### 带恒流源的差分放大电路

**电路结构**
```
        VCC
         |
        [Rc1]     [Rc2]
         |         |
        Q1        Q2
         |         |
Vi1 -----+         +----- Vi2
         |         |
        [Re]      [Re]
         |         |
         +----+----+
              |
             Q3   ← 恒流源
             |
            [Rb1]   [Rb2]
             |       |
            VEE     GND
```

**优点**
- 用晶体管恒流源代替Re，大大提高共模抑制比
- 恒流源动态电阻极大，共模增益极低
- 集成电路中的标准结构

### 带有源负载的差分放大电路

**电路结构**
```
        VCC
         |
        Q3        Q4  ← 电流镜有源负载
         |         |
        Q1        Q2  ← 差分对管
         |         |
Vi1 -----+         +----- Vi2
         |         |
        [Re]      [Re]
         |         |
         +----+----+
              |
             Q5    ← 恒流源
              |
             VEE
```

**优点**
- 有源负载提供高阻抗，电压增益大大提高
- 实现双端转单端输出
- 现代运放的典型输入级结构



## 差分放大电路的传输特性

### 大信号分析

**转移特性曲线**
```
  Ic/Iee
   ↑
  1.0 │
      │        ／
      │      ／
      │    ／
  0.5 │───／──────────
      │ ／
      │／
  0.0 └───────┴───────→ Vid
     -4VT    0     +4VT
```

**线性范围**
- 当 |Vid| < VT ≈ 26mV时，工作在线性区
- 当 |Vid| > 4VT ≈ 100mV时，进入限幅区

**应用意义**
- 小信号放大：确保输入差分信号足够小
- 限幅应用：利用非线性区实现限幅功能



## 输入输出连接方式

### 四种典型组态

| 组态                 | 输入方式 | 输出方式 | 差模增益 | 特点               |
| -------------------- | -------- | -------- | -------- | ------------------ |
| 双端输入<br>双端输出 | 平衡输入 | 平衡输出 | gmRc     | 对称性好，CMRR高   |
| 双端输入<br>单端输出 | 平衡输入 | 单端输出 | gmRc/2   | 增益减半，便于级联 |
| 单端输入<br>双端输出 | 单端输入 | 平衡输出 | gmRc     | 单端转双端，CMRR高 |
| 单端输入<br>单端输出 | 单端输入 | 单端输出 | gmRc/2   | 最常见应用形式     |

### 单端输入等效分析
单端输入可以等效为双端输入情况：
- 差模分量：Vid = Vi
- 共模分量：Vic = Vi/2



## 典型应用电路

### 仪器仪表放大器

**三运放结构**
```
        Rg
   +----/\/\/----+
   |             |
Vi1--[R]--[A1]   |   [A3]-- Vo
        |        |    |
        +--------+----+
        |        |
Vi2--[R]--[A2]   |
        |        |
        +--------+
           [R]
```

**特点**
- 输入阻抗极高
- 增益可调：Ad = 1 + 2R/Rg
- CMRR极高（>100dB）

### 差分探头放大器

**电路结构**
```
信号源+ --[R1]--+--[A1]--+
              |        |
             [C1]     [Rf]-- Vo
              |        |
信号源- --[R2]--+--[A2]--+
              |        |
             [C2]     [Rf]
              |        |
              +--- GND
```

**应用**
- 示波器差分探头
- 浮地信号测量
- 医疗仪器隔离测量



## 设计规则与最佳实践

**对称性设计**
*   选择配对晶体管，确保β、Vbe等参数一致
*   使用激光微调电阻或匹配电阻网络
*   版图设计时考虑热对称和几何对称

**偏置设计**
*   恒流源偏置是提高CMRR的关键
*   电流源输出阻抗要足够大
*   考虑温度稳定性

**频率补偿**
*   高频应用时需要考虑相位匹配
*   必要时加入补偿电容保持稳定性

**布局布线**
*   输入对称走线，长度相等
*   敏感信号远离干扰源
*   地线设计要避免地环路

**保护措施**
*   输入端加限幅保护二极管
*   防止输入过压损坏
*   静电防护措施



## 性能优化技巧

### 提高CMRR的方法
1. **使用精密匹配电阻**
2. **采用高精度恒流源**
3. **选择高β值晶体管**
4. **优化电路对称性**
5. **采用共模反馈技术**

### 扩展线性范围
1. **增加发射极负反馈电阻**
2. **采用非线性补偿技术**
3. **使用多级级联结构**

### 降低失调电压
1. **晶体管精密匹配**
2. **采用失调调零电路**
3. **自动校准技术**



## 测试与调试方法

**静态测试**
*   测量各晶体管工作点，确保对称
*   检查恒流源电流值
*   测量输入失调电压

**动态测试**
*   差模增益测试：输入差模信号，测量输出
*   共模增益测试：输入共模信号，测量输出
*   CMRR计算：CMRR = Ad/Ac

**故障排查**
*   **增益不对称**：检查晶体管配对、电阻匹配
*   **CMRR低**：检查恒流源、对称性
*   **工作点漂移**：检查偏置稳定性、温度补偿

**测试电路**
```
信号发生器--[R]--+--[差分电路]-- 示波器
                |
               [R]
                |
信号发生器------+
```



## 集成电路中的差分放大

### 集成运放输入级
现代集成运放普遍采用带有源负载的差分输入级，具有：
- 高输入阻抗
- 高电压增益
- 高CMRR
- 宽输入共模范围

### 版图设计考虑
- 交叉耦合布局提高匹配度
- 共同质心结构降低梯度影响
- 保护环隔离减少衬底耦合

> **设计提示**：差分放大电路的核心价值在于其抑制共模干扰的能力。在实际应用中，需要根据信号特点、精度要求和环境条件选择合适的电路结构和器件。对于高精度应用，仪器仪表放大器是更好的选择；对于一般应用，运放构成的差分电路已能满足要求。