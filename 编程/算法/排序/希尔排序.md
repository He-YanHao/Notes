# 希尔排序

希尔排序是插入排序的一种更高效的改进版本，由 Donald Shell 于 1959 年提出。它的核心思想是**使数组中任意间隔为 `h` 的元素都是有序的**，这样的数组被称为 **`h` 有序数组**。希尔排序也因其得名。

希尔排序通过一个**增量序列（Gap Sequence）**，将整个待排序的序列分割成若干个子序列，分别对这些子序列进行**直接插入排序**。

**算法步骤**

1. **选择增量序列**：首先确定一个初始增量 `gap`（通常是数组长度的一半）。
2. **分组进行插入排序**：将数组元素按照 `gap` 的间隔进行分组，并对每一组分别进行直接插入排序。
3. **缩小增量**：缩小 `gap` 的值（例如，`gap = gap / 2`），重复第 2 步的分组和排序。
4. **直至增量为1**：当 `gap` 减小到 1 时，对整个数组进行一次直接插入排序，此时数组必然有序。

图解示例

假设我们要对数组 `[8, 9, 1, 7, 2, 3, 5, 4, 6, 0]` 进行升序排序。

**初始数组：** `8, 9, 1, 7, 2, 3, 5, 4, 6, 0`

**第1轮排序（初始 gap = 10 / 2 = 5）**

- 将数组分为 5 组，间隔为 5 的元素为一组：
    - `(8, 3)`, `(9, 5)`, `(1, 4)`, `(7, 6)`, `(2, 0)`
- 分别对每组进行**直接插入排序**：
    - `(3, 8)`, `(5, 9)`, `(1, 4)`, `(6, 7)`, `(0, 2)`
- 排序后的数组为：`3, 5, 1, 6, 0, 8, 9, 4, 7, 2`
- 可以看到，较小的元素（如0, 1, 2, 3）已经被移动到了数组的前面。

**第2轮排序（gap = 5 / 2 = 2）**

- 将数组分为 2 组，间隔为 2 的元素为一组：
    - `(3, 1, 0, 9, 7)`, `(5, 6, 8, 4, 2)`
- 分别对每组进行**直接插入排序**：
    - `(0, 1, 3, 7, 9)`, `(2, 4, 5, 6, 8)`
- 排序后的数组为：`0, 2, 1, 4, 3, 5, 7, 6, 9, 8`
- 数组已经更加接近有序了。

**第3轮排序（gap = 2 / 2 = 1）**

- 当 `gap = 1` 时，就是对整个数组进行**直接插入排序**。
- 此时的数组 `[0, 2, 1, 4, 3, 5, 7, 6, 9, 8]` 已经基本有序，只需要进行少量的比较和移动。
- 最终得到有序数组：`0, 1, 2, 3, 4, 5, 6, 7, 8, 9`

```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

// 希尔排序函数
void shellSort(int arr[], int n) {
    // 初始间隔gap设置为数组长度的一半，然后逐步缩小间隔
    for (int gap = n / 2; gap > 0; gap /= 2) {
        // 对每个间隔进行插入排序
        for (int i = gap; i < n; i++) {
            int temp = arr[i]; // 当前需要插入的元素
            int j;
            
            // 对间隔为gap的元素进行插入排序
            for (j = i; j >= gap && arr[j - gap] > temp; j -= gap) {
                arr[j] = arr[j - gap]; // 将较大的元素向后移动
            }
            arr[j] = temp; // 插入保存的元素
        }
    }
}

// 打印数组函数
void printArray(int arr[], int size) {
    for (int i = 0; i < size; i++) {
        printf("%d ", arr[i]);
    }
    printf("\n");
}

// 生成随机数组函数
void generateRandomArray(int arr[], int size, int min, int max) {
    srand(time(NULL));
    for (int i = 0; i < size; i++) {
        arr[i] = min + rand() % (max - min + 1);
    }
}

int main() {
    int size;
    printf("请输入数组大小: ");
    scanf("%d", &size);
    
    int *arr = (int*)malloc(size * sizeof(int));
    
    // 生成随机数组
    generateRandomArray(arr, size, 1, 100);
    
    printf("排序前的数组: \n");
    printArray(arr, size);
    
    // 执行希尔排序
    shellSort(arr, size);
    
    printf("排序后的数组: \n");
    printArray(arr, size);
    
    free(arr);
    return 0;
}
```





