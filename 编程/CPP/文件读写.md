在 C++ 中，文件读写主要通过标准库中的 `<fstream>` 头文件提供的类实现。以下是核心类和函数的详细说明及使用示例：

---

### **核心类**
| 类名       | 用途                   | 继承自     |
| ---------- | ---------------------- | ---------- |
| `ofstream` | 文件写入（输出文件流） | `ostream`  |
| `ifstream` | 文件读取（输入文件流） | `istream`  |
| `fstream`  | 同时支持读写           | `iostream` |

---

### **文件打开模式（I/O 模式）**
在打开文件时可指定模式：
```cpp
std::ios::in      // 读模式（默认 ifstream）
std::ios::out     // 写模式（默认 ofstream，会覆盖文件）
std::ios::app     // 追加模式（写入到文件末尾）
std::ios::ate     // 打开后定位到文件末尾
std::ios::binary  // 二进制模式
std::ios::trunc   // 清空文件（默认 out 模式的行为）
```
**组合示例**：  
`std::ios::out | std::ios::app` → 追加写入

---

### **文件写入（Output）**
#### 1. 使用 `ofstream`
```cpp
#include <fstream>

int main() {
    // 创建并打开文件（覆盖写入）
    std::ofstream outFile("data.txt");
    // 或指定模式：std::ofstream outFile("data.txt", std::ios::app);

    if (outFile.is_open()) {  // 检查是否成功打开
        outFile << "Line 1\n";   // 写入文本
        outFile << 42 << " " << 3.14 << "\n";  // 写入数字
        outFile.close();  // 关闭文件
    }
    return 0;
}
```

#### 2. 使用 `fstream` 写入
```cpp
std::fstream file;
file.open("log.txt", std::ios::out | std::ios::app);
if (file) {  // 简写检查
    file << "[LOG] Event occurred\n";
    file.close();
}
```

---

### **文件读取（Input）**
#### 1. 使用 `ifstream` 逐词读取
```cpp
#include <fstream>
#include <iostream>

int main() {
    std::ifstream inFile("data.txt");
    if (!inFile) { /* 错误处理 */ }

    std::string word;
    while (inFile >> word) {  // 以空格为分隔符读取单词
        std::cout << word << "\n";
    }
    inFile.close();
}
```

#### 2. 逐行读取
```cpp
std::ifstream inFile("data.txt");
std::string line;
while (std::getline(inFile, line)) {  // 读取整行
    std::cout << line << "\n";
}
```

#### 3. 读取单个字符
```cpp
char c;
while (inFile.get(c)) {  // 读取每个字符
    std::cout << c;
}
```

---

### **二进制文件读写**
#### 1. 写入二进制数据
```cpp
struct Point { double x, y; };

std::ofstream binFile("points.bin", std::ios::binary);
Point p{1.1, 2.2};
binFile.write(reinterpret_cast<const char*>(&p), sizeof(Point));
```

#### 2. 读取二进制数据
```cpp
std::ifstream binFile("points.bin", std::ios::binary);
Point p;
binFile.read(reinterpret_cast<char*>(&p), sizeof(Point));
std::cout << "x=" << p.x << ", y=" << p.y;
```

---

### **文件指针操作**
| 函数                        | 用途                  |
| --------------------------- | --------------------- |
| `tellg()` / `tellp()`       | 获取读/写指针当前位置 |
| `seekg(pos)` / `seekp(pos)` | 设置读/写指针位置     |
| `seekg(offset, origin)`     | 从指定位置偏移        |

**示例**：
```cpp
std::fstream file("data.txt", std::ios::in | std::ios::out);
file.seekg(10, std::ios::beg);  // 将读指针移到第10字节处
file.seekp(0, std::ios::end);   // 将写指针移到文件末尾
```

---

### **错误状态检查**
| 函数      | 用途                     |
| --------- | ------------------------ |
| `good()`  | 操作正常                 |
| `eof()`   | 到达文件末尾             |
| `fail()`  | 非致命错误（如格式错误） |
| `bad()`   | 致命错误（如磁盘损坏）   |
| `clear()` | 清除错误状态             |

**使用示例**：
```cpp
std::ifstream file("data.txt");
if (!file) {
    std::cerr << "打开文件失败！";
    return;
}

int value;
file >> value;
if (file.fail()) {
    std::cerr << "读取失败，非数字内容";
    file.clear();  // 清除错误状态
}
```

---

### **完整示例：文件复制**
```cpp
#include <fstream>

int main() {
    std::ifstream src("source.jpg", std::ios::binary);
    std::ofstream dst("copy.jpg", std::ios::binary);

    if (!src || !dst) return 1;

    // 高效复制：逐块读取/写入
    char buffer[4096];
    while (src.read(buffer, sizeof(buffer)) || src.gcount()) {
        dst.write(buffer, src.gcount());
    }

    src.close();
    dst.close();
}
```

---

### **最佳实践**
1. **RAII 原则**：利用构造函数打开文件，析构函数自动关闭
   ```cpp
   {
       std::ofstream tmpFile("temp.txt"); // 离开作用域自动关闭
   } // 文件在此关闭
   ```
2. **检查文件状态**：所有操作前检查 `is_open()` 或 `if (file)`
3. **二进制文件**：处理非文本数据时务必使用 `std::ios::binary`
4. **缓冲区**：大文件操作时使用缓冲区提升性能
5. **路径处理**：使用 C++17 的 `std::filesystem` 处理路径（需 `<filesystem>` 头文件）

通过掌握这些核心类和函数，您可以在 C++ 中高效实现各种文件操作需求。