# 宏与条件编译

## 宏定义

### 定义和取消宏

 ` #define ` 为宏定义，如：

```c
#define ABC XYZ
```

则表示定义了宏ABC，会对程序中的所以 ` ABC ` 替换为 ` XYZ ` 。

 `#undef ` 表示取消定义宏，如

```c
#undef ABC
```

表示取消定义宏，则宏定义ABC不再生效。

如果宏比较长，一行写不下，可以用 \ 来分行写。

```c
#define  message_for(a, b)  \
    printf(#a " and " #b ": We love you!\n")
```

### 系统定义的宏

当包含特定的头文件时，往往会自带一些宏定义：

| 宏         | 描述                                                |
| :--------- | :-------------------------------------------------- |
| `__DATE__` | 当前日期，一个以 "MMM DD YYYY" 格式表示的字符常量。 |
| `__TIME__` | 当前时间，一个以 "HH:MM:SS" 格式表示的字符常量。    |
| `__FILE__` | 这会包含当前文件名，一个字符串常量。                |
| `__LINE__` | 这会包含当前行号，一个十进制常量。                  |
| `__STDC__` | 当编译器以 ANSI 标准编译时，则定义为 1。            |



##  条件编译（通过条件判断方式）

### #if

`#if` 的一般含义是如果#if后面的常量表达式为true，则编译它与#endif之间的代码，否则跳过这些代码。

```c
#if 1
// 执行
#endif
//#ifdef与#endif必须成对出现

#if 0
// 不执行
#endif
```

`#endif` 标识一个 `#if` 块的结束。

### #else

`#else` 命令的功能有点象C语言中的 `else`，`#else` 建立另一选择（在#if失败的情况下）。

```c
#if 0
// 不执行
#else
// 执行
#endif
```



### #elif

`#elif`命令意义与 `elseif` 相同，它形成一个 `ifelse-if` 阶梯状语句，可进行多种编译选择。 

```c
#if 0
// 不执行
#elif 0
// 执行
#else
// 不执行
#endif
```

其中 ` #else ` 最多可以出现一次。

#### #else和#elif对比

-   `#else` 包含条件，`#elif` 不包含条件，只作为最终可能。
-   `#else` 只能有一个，`#elif` 可以有无数个。



##  条件编译（通过是否定义宏方式）

### #ifdef

如果有定义就执行。

```c
#define ABC
#ifdef  ABC
// 执行
#endif
```



### #ifndef

如果无定义就执行。

```c
#define ABC
#ifndef ABC
// 不执行
#endif
```








