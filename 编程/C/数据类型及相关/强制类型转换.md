# 强制类型转换

## 基本描述

强制类型转换是程序员在代码中明确指示编译器，忽略精度损失的后果，将一种数据类型的值转换为另一种数据类型。

它与编译器自动进行的隐式类型转换相对。

基本格式是：

```c
int d = 0;
float f = 5.1;
d = (int)f;
printf("%d\n",d);
//d=5
```



其中

浮点数转化为整数，会直接截断小数部分，只保留整数部分。不会进行四舍五入。

大尺寸整数转化为小尺寸整数，进行高位截断，只保留低位的字节。



小尺寸整数转化为大尺寸整数

**符号扩展**：如果源类型是有符号数且为负数，高位补1；如果是正数，高位补0。

**零扩展**：如果源类型是无符号数，高位一律补0。



有符号与无符号整数之间转换

**位模式不变**，但解释方式改变。

编译器会直接使用相同的二进制位，但按照新的类型（有符号或无符号）的规则来解读它。



指针类型之间的转换

这是一种非常强大但也极其危险的操作。它告诉编译器：“请将这块内存按照新的指针类型来解读。”





## 强制转化的后果

1.  **精度损失**：从浮点数转换到整数，或从大类型转换到小类型时，数据可能会丢失。
2.  **数值改变**：在有符号和无符号之间转换，或超出目标类型表示范围时，数值可能发生意想不到的改变。
3.  **可读性与维护性**：过度使用强制转换会使代码难以阅读和理解，应确保每次转换的意图都是清晰的。
4.  **并非万能**：强制转换并不能将任意类型转换为任意其他类型。例如，你不能直接将一个 `int` 强制转换成一个 `struct`。