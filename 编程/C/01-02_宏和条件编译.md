# 宏与条件编译

##  宏定义

### 定义和取消宏

 ` #define ` 为宏定义，如：

```c
#define ABC XYZ
```

则表示定义了宏ABC，会对程序中的所以 ` ABC ` 替换为 ` XYZ ` 。

 `#undef ` 表示取消定义宏，如

```c
#undef ABC
```

表示取消定义宏，则宏定义ABC不再生效。

如果宏比较长，一行写不下，可以用 \ 来分行写。

```c
#define  message_for(a, b)  \
    printf(#a " and " #b ": We love you!\n")
```

### 系统定义的宏

| 宏         | 描述                                                |
| :--------- | :-------------------------------------------------- |
| `__DATE__` | 当前日期，一个以 "MMM DD YYYY" 格式表示的字符常量。 |
| `__TIME__` | 当前时间，一个以 "HH:MM:SS" 格式表示的字符常量。    |
| `__FILE__` | 这会包含当前文件名，一个字符串常量。                |
| `__LINE__` | 这会包含当前行号，一个十进制常量。                  |
| `__STDC__` | 当编译器以 ANSI 标准编译时，则定义为 1。            |

##  条件编译

### #ifdef

 ` #define ` 还可用于条件编译。

借助 ` #ifdef ` 和 ` #endif ` 或 ` #ifndef ` 和 ` #endif ` 。例：

```c
#ifdef ABC//如果定义了宏ABC
程序语句1//执行程序语句1 
#else//否则
程序语句2//执行程序语句2
#endif//结束
//#ifdef与#endif必须成对出现
```

其中 ` #else ` 最多可以出现一次。

### #ifndef

```c
#ifndef ABC//如果没有定义了宏ABC
程序语句1//执行程序语句1
#else//否则
程序语句2//执行程序语句2
#endif//结束
//#ifndef与#endif必须成对出现
```

### #if

 ` #if ` 的使用：

```c
#if 表达式1        //若表达式1为真
程序语句1          //则执行程序语句1
#elif 表达式2      //否则再次判断表达式2是否为真
程序语句2          //若表达式2为真，执行程序语句2
#elif 表达式3      //否则再次判断表达式3是否为真
程序语句3          //若表达式3为真，执行程序语句3
#else             //否则
程序语句4          //执行程序语句4
#endif            //结束
```

 ` #elif ` 相当于 ` else if ` ， ` #else ` 依旧是只能出现一次。

任意数量的 ` #elif ` 指令可以出现在 ` #if ` 和 ` #elif ` 指令之间，但最多允许一个 ` #else ` 指令。 ` #else ` 指令（如果有）必须是 ` #elif ` 之前的最后一个指令。

 ` defined( ) ` 是一个仅能在在 ` #if ` `  #elif ` 里使用的命令，在其他位置不可用，若 ( ) 里面的宏已经被定义过了，则该值为1，否则为0。

### 作用

宏定义可以用于版本管理。


