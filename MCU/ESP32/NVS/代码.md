```

    // /* 直接读取到栈上的结构体变量 */
    // // 申请对应结构体
    // test_data_t test_data;
    // // 获取结构体长度
    // size_t test_data_size = sizeof(test_data_t);

    // // 使用 my_handle 这个句柄
    // // "test_data" 使用这个数据键名
    // // test_data 数据位置
    // /* 若此处为非空 则为读取第四个参数大小的数据保存到这个位置 */
    // // test_data_size 数据大小
    // err = nvs_get_blob(my_handle, "test_data", &test_data, &test_data_size);

    // if (err == ESP_OK)
    // {
    //     // 输出正确数据

    // } else if (err == ESP_ERR_NVS_NOT_FOUND) {
    //     // 错误处理
    //     printf("输出结构体出错\n");
    // }

```



```c
// esp_err_t save_test_data(void)
// {
//     // 句柄 所有操作都是用这个句柄
//     nvs_handle_t my_handle;
//     // 保存错误类型
//     esp_err_t err;
//     // 创建样本测试数据
//     for(int i = 0; i < 100; i++)
//     {
//         num++;
//         nvs_num_w[i] = i + num;
//     }
//     // 打开NVS句柄
//     // 打开 STORAGE_NAMESPACE() ，以 NVS_READWRITE(可读可写) 的形式读取，读到的数据保存到 my_handle里。
//     err = nvs_open(STORAGE_NAMESPACE, NVS_READWRITE, &my_handle);
//     if (err != ESP_OK) {
//         printf("打开句柄出错\n");
//         return err;
//     }
//     // Write blob
//     // 将结构体 test_data 以二进制格式写入到 RAM 存储中。
//     // 使用 my_handle 句柄，以 "test_data" 键名，保存到 test_data 位置，大小为结构体大小sizeof(test_data_t)
//     err = nvs_set_blob(my_handle, "test_data", &nvs_num_w[0], sizeof(nvs_num_w));
//     if (err != ESP_OK) {
//         printf("写入到 RAM 存储中出错\n");
//         nvs_close(my_handle); // 写入失败就报错并关闭再退出
//         return err;
//     }
//     // Commit
//     // 执行提交操作，将内存中的修改写入物理闪存。
//     err = nvs_commit(my_handle);
//     if (err != ESP_OK) {
//         printf("将内存中的修改写入物理闪存出错\n");
//     }
//     nvs_close(my_handle);
//     return err;
// }

// esp_err_t read_stored_blobs(void)
// {
//     nvs_handle_t my_handle;
//     esp_err_t err;
//     err = nvs_open(STORAGE_NAMESPACE, NVS_READONLY, &my_handle);
//     if (err != ESP_OK) 
//     {
//         return err;
//     }
//     /* 读取数组数据 */
//     // 确定数组长度
//     size_t required_size = 0;
//     // my_handle 使用这个句柄
//     // "array_data" 使用这个数据键名
//     // 若此处为空 则为读取数据键名对应参数的数据的大小保存到参数四
//     err = nvs_get_blob(my_handle, "test_data", NULL, &required_size);
//     if (err == ESP_OK) {
//         // 申请 堆空间
//         uint16_t* array_data = malloc(required_size);
//         // 和上次车不多 获取了数据的长度就开始拷贝数据了
//         err = nvs_get_blob(my_handle, "test_data", array_data, &required_size);
//         // 读取数据没有问题就开始输出数据
//         if (err == ESP_OK) {
//             for (int i = 0; i < required_size / sizeof(uint16_t); i++)
//             {
//                 printf("%d\n",array_data[i]);
//             }
//         }
//         // 释放掉申请的堆空间
//         free(array_data);
//     } else if (err == ESP_ERR_NVS_NOT_FOUND) // 错误处理
//     {
//         printf("输出数组出错\n");
//     }
//     //使用句柄关闭
//     nvs_close(my_handle);
//     // 一切正常
//     return ESP_OK;
// }
```

