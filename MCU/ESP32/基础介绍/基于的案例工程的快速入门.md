# 基于的案例工程的快速入门

## 代码

```c
#include <stdio.h>
#include <inttypes.h>
#include "sdkconfig.h"
#include "freertos/FreeRTOS.h"
#include "freertos/task.h"
#include "esp_chip_info.h"
#include "esp_flash.h"
#include "esp_system.h"

void app_main(void)
{
    //输出Hello world!，ESP32自动重定向到串口0。
    printf("Hello world!\n");

    //先申请一个专用于存储设备信息的类。
    esp_chip_info_t chip_info;
    //读取设备信息，并存储到上一句申请的类里。
    esp_chip_info(&chip_info);

    printf("This is %s chip with %d CPU core(s), %s%s%s%s, ",
           CONFIG_IDF_TARGET,
           chip_info.cores,
           (chip_info.features & CHIP_FEATURE_WIFI_BGN) ? "WiFi/" : "",
           (chip_info.features & CHIP_FEATURE_BT) ? "BT" : "",
           (chip_info.features & CHIP_FEATURE_BLE) ? "BLE" : "",
           (chip_info.features & CHIP_FEATURE_IEEE802154) ? ", 802.15.4 (Zigbee/Thread)" : "");

    //获取并输出版本号
    unsigned major_rev = chip_info.revision / 100;
    unsigned minor_rev = chip_info.revision % 100;
    printf("silicon revision v%d.%d, ", major_rev, minor_rev);

    uint32_t flash_size;
    //NULL参数表示获取主Flash大小，ESP32常常有外置Flash。
    if(esp_flash_get_size(NULL, &flash_size) != ESP_OK) {
        //获取闪存大小失败
        printf("Get flash size failed");
        return;
    }

    //判断内置还是外挂Flash，并输出大小。
    printf("%" PRIu32 "MB %s flash\n", flash_size / (uint32_t)(1024 * 1024),
           (chip_info.features & CHIP_FEATURE_EMB_FLASH) ? "embedded" : "external");

    //esp_get_minimum_free_heap_size()监控堆内存使用情况
    printf("Minimum free heap size: %" PRIu32 " bytes\n", esp_get_minimum_free_heap_size());

    //循环发送还在等待的时间
    for (int i = 10; i >= 0; i--) {
        printf("Restarting in %d seconds...\n", i);
        vTaskDelay(1000 / portTICK_PERIOD_MS);
    }
    printf("Restarting now.\n");
    //数据直接送到串口
    fflush(stdout);
    //软重启
    esp_restart();
}
```



## 输出

### app_main()启动前

```
Executing action: monitor
Running idf_monitor in directory /home/he/esp/hello_world
Executing "/home/he/.espressif/python_env/idf6.1_py3.12_env/bin/python /home/he/esp/esp-idf/tools/idf_monitor.py -p /dev/ttyACM0 -b 115200 --toolchain-prefix xtensa-esp32s3-elf- --target esp32s3 --revision 0 /home/he/esp/hello_world/build/hello_world.elf /home/he/esp/hello_world/build/bootloader/bootloader.elf -m '/home/he/.espressif/python_env/idf6.1_py3.12_env/bin/python' '/home/he/esp/esp-idf/tools/idf.py' '-p' '/dev/ttyACM0'"...
--- esp-idf-monitor 1.8.0 on /dev/ttyACM0 115200
--- Quit: Ctrl+] | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H
I (108) esp_image: segment 3: paddr=00020020 vaddr=42000020 sizeESP-ROM:esp32s3-20210327
Build:Mar 27 2021
rst:0x15 (USB_UART_CHIP_RESET),boot:0x8 (SPI_FAST_FLASH_BOOT)
Saved PC:0x4037896a
--- 0x4037896a: esp_cpu_wait_for_intr at /home/he/esp/esp-idf/components/esp_hw_support/cpu.c:64
SPIWP:0xee
mode:DIO, clock div:1
load:0x3fce2820,len:0x1588
load:0x403c8700,len:0xda0
--- 0x403c8700: _stext at ??:?
load:0x403cb700,len:0x2fa0
entry 0x403c8908
--- 0x403c8908: call_start_cpu0 at /home/he/esp/esp-idf/components/bootloader/subproject/main/bootloader_start.c:25
I (24) boot: ESP-IDF v6.1-dev-450-g286b8cb76d 2nd stage bootloader
I (25) boot: compile time Nov 10 2025 18:10:04
I (25) boot: Multicore bootloader
I (26) boot: chip revision: v0.2
I (29) boot: efuse block revision: v1.3
I (33) boot.esp32s3: Boot SPI Speed : 80MHz
I (37) boot.esp32s3: SPI Mode       : DIO
I (40) boot.esp32s3: SPI Flash Size : 2MB
I (44) boot: Enabling RNG early entropy source...
I (49) boot: Partition Table:
I (51) boot: ## Label            Usage          Type ST Offset   Length
I (57) boot:  0 nvs              WiFi data        01 02 00009000 00006000
I (64) boot:  1 phy_init         RF data          01 01 0000f000 00001000
I (70) boot:  2 factory          factory app      00 00 00010000 00100000
I (77) boot: End of partition table
I (80) esp_image: segment 0: paddr=00010020 vaddr=3c020020 size=07928h ( 31016) map
I (93) esp_image: segment 1: paddr=00017950 vaddr=3fc90100 size=02a6ch ( 10860) load
I (97) esp_image: segment 2: paddr=0001a3c4 vaddr=40374000 size=05c54h ( 23636) load
I (108) esp_image: segment 3: paddr=00020020 vaddr=42000020 size=10fcch ( 69580) map
I (123) esp_image: segment 4: paddr=00030ff4 vaddr=40379c54 size=06498h ( 25752) load
I (129) esp_image: segment 5: paddr=00037494 vaddr=50000000 size=00024h (    36) load
I (134) boot: Loaded app from partition at offset 0x10000
I (134) boot: Disabling RNG early entropy source...
I (148) cpu_start: Multicore app
I (156) cpu_start: GPIO 44 and 43 are used as console UART I/O pins
I (157) cpu_start: Pro cpu start user code
I (157) cpu_start: cpu freq: 160000000 Hz
I (159) app_init: Application information:
I (162) app_init: Project name:     hello_world
I (167) app_init: App version:      1
I (170) app_init: Compile time:     Nov 10 2025 18:10:04
I (175) app_init: ELF file SHA256:  b7c37a149...
I (179) app_init: ESP-IDF:          v6.1-dev-450-g286b8cb76d
I (185) efuse_init: Min chip rev:     v0.0
I (189) efuse_init: Max chip rev:     v0.99 
I (193) efuse_init: Chip rev:         v0.2
I (196) heap_init: Initializing. RAM available for dynamic allocation:
I (203) heap_init: At 3FC933A0 len 00056370 (344 KiB): RAM
ep state
I (248) sleep_gpio: Enable automatic switching of GPIO sleep configuration
I (255) main_task: Started on CPU0
I (265) main_task: Calling app_main()
```

### 程序输出

```
Hello world!
This is esp32s3 chip with 2 CPU core(s), WiFi/BLE, silicon revision v0.2, 2MB external flash
Minimum free heap size: 400296 bytes
Restarting in 10 seconds...
Restarting in 9 seconds...
Restarting in 8 seconds...
Restarting in 7 seconds...
Restarting in 6 seconds...
Restarting in 5 seconds...
Restarting in 4 seconds...
Restarting in 3 seconds...
Restarting in 2 seconds...
Restarting in 1 seconds...
Restarting in 0 seconds...
Restarting now.
```



