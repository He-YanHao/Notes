# SD卡标准引脚

## SD卡标准引脚总览

**标准 SD 卡（全尺寸 / MicroSD）逻辑引脚完全一致**，只是物理封装不同。

|        | SD Mode         |      |                     |          | SPI Mode |                 |
| ------ | --------------- | ---- | ------------------- | -------- | -------- | --------------- |
| 引脚号 | 名称            | 方向 | 说明                | 名称     | 方向     | 说明            |
| 1      | **DAT3 / CS**   | I/O  | 数据线 3 / SPI 片选 | **CS**   | 输入     | 片选 低电平有效 |
| 2      | **CMD / MOSI**  | I/O  | 命令线 / SPI 主出   | **DI**   | 输入     | 数据输入        |
| 3      | **VSS**1        | GND  | 电源地              | **VSS**1 | GND      | 电源地          |
| 4      | **VDD**         | VDD  | 电源正极            | **VDD**  | VDD      | 电源正极        |
| 5      | **CLK / SCK**   | 输入 | 时钟                | **SCLK** | 输入     | 时钟            |
| 6      | **VSS**2        | GND  | 电源地              | **VSS**2 | GND      | 电源地          |
| 7      | **DAT0 / MISO** | I/O  | 数据线 0            | **DO**   | 推挽I/O  | 数据输出        |
| 8      | **DAT1**        | I/O  | 数据线 1            | **RSV**  |          |                 |
| 9      | **DAT2**        | I/O  | 数据线 2            | **RSV**  |          |                 |

>   SD卡默认SD模式，可以通过发送RESTE命令（CMD0） 时，拉低CS进入SPI模式。

SD卡使用9-pin的接口，其中3根电源线、1根时钟线、1根命令线和4根数据线，具体说明如下：

-   **CLK：**同步时钟线，由SDIO主机产生，即由STM32控制器输出；使用SPI模式时，该引脚与SPI总线的SCK时钟信号相连；
-   **CMD：**命令控制线，SDIO主机通过该线发送命令控制SD卡，如果命令要求SD卡提供应答(响应)，SD卡也是通过该线传输应答信息； 使用SPI模式时，该引脚与SPI总线的MOSI信号相连，SPI主机通过它向SD卡发送命令及数据，但因为SPI总线的MOSI仅用于主机向从机输出信号，所以SD卡 返回应答信息时不使用该信号线；
-   **D0-3：**在SDIO模式下，它们均为数据线，传输读写数据，SD卡可将D0拉低表示忙状态；在SPI模式下，D0与SPI总线的MISO信号相连， SD卡通过该信号线向主机发送数据或响应，D3与总线的CS信号相连，SPI主机通过该信号线选择要通讯的SD卡。
-   **VDD、VSS1、VSS2：**电源和地信号，其中Micro SD卡不包含VSS2信号，即Micro SD卡仅有8根线。

### 图片

![](./pic/SDcard001.png)

## 三种工作模式与引脚复用

SD 卡支持 **3 种通信模式**：

-   **SD 模式（SDIO）：**MCU / SoC

    -   **1-bit 模式**：简化布线

    -   **4-bit 模式**：高速传输

        >   **LVGL、文件系统、图片加载 → 必须 4-bit**

-   **SPI 模式：**低端 MCU

### SD 模式（SDIO）

使用引脚：

```
CMD   → 命令
CLK   → 时钟
DAT0  → 数据
DAT1  → 数据
DAT2  → 数据
DAT3  → 数据
VDD / VSS
```

数据宽度：

-   **1-bit**：DAT0
-   **4-bit**：DAT0–DAT3



### SPI 模式（最容易理解）

```
SPI CS   ← DAT3
SPI MOSI ← CMD
SPI MISO ← DAT0
SPI SCK  ← CLK
```

**DAT1、DAT2 在 SPI 模式下不用**



## 每个引脚的说明

### 命令线CMD

-   双向
-   发送 **CMD0 / CMD8 / CMD55 / ACMD41**
-   有 CRC 校验（SPI 模式下部分命令需要）



### 时钟CLK

-   由主机输出
-   初始化阶段：
    -   ≤ 400 kHz
-   工作阶段：
    -   可达 25 MHz / 50 MHz





### 最重要的数据线DAT0

-   **初始化必须存在**
-   SPI 模式下是 **MISO**
-   忙状态（写入时拉低）



### DAT1 / DAT2

-   仅在 **4-bit SD 模式**下使用
-   SPI 模式下悬空即可



### 非常特殊DAT3

| 模式     | 功能     |
| -------- | -------- |
| SD 模式  | 数据线   |
| SPI 模式 | CS       |
| 上电     | 模式选择 |

-   **上电时拉低 → SPI 模式**
-   **上电时拉高 → SD 模式**
-   **硬件设计必须注意上拉**



### VDD / VSS

-   VDD：2.7V–3.6V（常见 3.3V）
-   建议：
    -   就近去耦 0.1µF + 1µF
    -   电源稳定后再初始化



## 同时连接多个SD卡

SDIO总线与多张SD卡连接时， 可以共用CLK信号线，其它的如CMD、D0~D3信号线是每张SD卡独立的。

对于STM32系列芯片来说，它的SDIO外设仅支持连接一个SDIO设备，即不可以同时连接2张或以上的SD卡



