# route



```
he@he-books ~/W/D/Notes (main)> ip route
default via 192.168.1.1 dev wlp4s0 proto dhcp src 192.168.1.164 metric 600 
192.168.1.0/24 dev wlp4s0 proto kernel scope link src 192.168.1.164 metric 600 
```



你这条 `ip route` 输出是当前主机的 **路由表**，也就是内核决定“数据包往哪里发”的规则。

我们逐条拆解：

------

## 第一条

```
default via 192.168.1.1 dev wlp4s0 proto dhcp src 192.168.1.164 metric 600
```

### 含义：

| 字段                | 含义                         |
| ------------------- | ---------------------------- |
| `default`           | 默认路由（匹配所有未知目标） |
| `via 192.168.1.1`   | 网关是 192.168.1.1           |
| `dev wlp4s0`        | 通过网卡 wlp4s0 发出去       |
| `proto dhcp`        | 由 DHCP 自动配置             |
| `src 192.168.1.164` | 本机IP                       |
| `metric 600`        | 路由优先级（越小优先级越高） |

------

### 🔹 这条的核心意思：

> 访问非本地网络的数据，全部发给 192.168.1.1

也就是：

```
你访问：
8.8.8.8
baidu.com
github.com
```

都会：

```
→ 发给 192.168.1.1（你的路由器）
→ 路由器帮你转发到公网
```

------

## 第二条

```
192.168.1.0/24 dev wlp4s0 proto kernel scope link src 192.168.1.164 metric 600
```

### 含义：

| 字段                | 含义         |
| ------------------- | ------------ |
| `192.168.1.0/24`    | 本地子网     |
| `dev wlp4s0`        | 通过该网卡   |
| `proto kernel`      | 内核自动生成 |
| `scope link`        | 直连网络     |
| `src 192.168.1.164` | 本机IP       |

------

### 🔹 核心意思：

> 访问 192.168.1.x 的机器，直接发过去，不用经过网关。

比如：

```
你访问：
192.168.1.10
192.168.1.20
```

数据包会：

```
→ 直接ARP查询MAC
→ 直接发给对方
```

不会走 192.168.1.1

------

# 🔥 用一句话总结你的路由表

```
局域网内 → 直接发
外网     → 交给 192.168.1.1
```

------

# 🔥 再给你画个数据流图

```
           Internet
               ↑
        192.168.1.1  ← 默认网关
               ↑
        你的电脑
        192.168.1.164
```

------

# 🔥 再给你进阶理解（你喜欢底层）

Linux 查路由顺序：

1. 从上到下匹配
2. 最精确的优先（最长掩码优先）
3. metric 决定优先级

如果你有：

```
192.168.1.0/24
192.168.0.0/16
default
```

访问 192.168.1.50 时会匹配：

```
192.168.1.0/24
```

因为它更精确。

------

# 🔥 你现在的网络状态说明

你是：

- 用无线网卡 `wlp4s0`
- DHCP 自动分配
- IP：192.168.1.164
- 网关：192.168.1.1

------

如果你愿意，我可以下一步带你看：

- `ip addr` 如何对应网卡
- ARP 表 (`ip neigh`)
- route cache 工作原理
- 或者手动加一条路由试试

你现在已经开始真正理解 Linux 网络栈了 👍
